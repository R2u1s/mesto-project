(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{zb:()=>F,EG:()=>T,Yc:()=>H,bj:()=>z,td:()=>O,IA:()=>I,d6:()=>J,O9:()=>w,AD:()=>U}),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"),new URL("https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg");var t=document.querySelector(".page"),r=document.querySelector(".cards__cards-list"),n=document.querySelector("#card").content,o=t.querySelector("#image"),c=o.querySelector(".popup__image"),a=o.querySelector(".popup__figcaption"),s=t.querySelector("#add-card"),i=s.querySelector('[name="Name"]'),u=s.querySelector('[name="link"]');function l(e){var t=e.querySelector(".cards__like-qty");"0"===t.textContent?t.classList.remove("cards__like-qty_active"):t.classList.value.includes("cards__like-qty_active")||t.classList.toggle("cards__like-qty_active")}function d(e,t,s,i,u,d){r.prepend(function(e,t,r,s,i,u){var d=n.querySelector(".cards__card").cloneNode(!0);return void 0===r&&(r=e),d.querySelector(".cards__title").textContent=e,d.querySelector(".cards__image").src=t,d.querySelector(".cards__image").alt=r,d.querySelector("#cardId").textContent=u,d.querySelector(".cards__like-qty").textContent=i.length.toString(),i.some((function(e){return e._id===f}))&&d.querySelector(".cards__like").classList.toggle("cards__like_active"),d.querySelector(".cards__like").addEventListener("click",(function(e){e.target.classList.toggle("cards__like_active"),e.target.classList.value.includes("cards__like_active")?m(d,u):h(d,u)})),l(d),p(d),s===f&&d.querySelector(".cards__delete").classList.add("cards__delete_active"),function(e){e.querySelector(".cards__image").addEventListener("click",(function(e){S(o);var t=e.target.closest(".cards__card").querySelector(".cards__title");c.src=e.target.src,a.textContent=t.textContent,c.alt=e.target.alt}))}(d),d}(e,t,s,i,u,d))}var p=function(e){e.querySelector(".cards__delete").addEventListener("click",(function(t){t.target.closest(".cards__card").remove(),v(e.querySelector("#cardId").textContent)}))},f="",_="https://nomoreparties.co/v1/plus-cohort-19",y="f666a8fe-ebaf-4340-9b7e-5a965925e3c4",v=function(e){return fetch("".concat(_,"/cards/").concat(e),{method:"DELETE",headers:{authorization:y}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))},m=function(e,t){return fetch("".concat(_,"/cards/likes/").concat(t),{method:"PUT",headers:{authorization:y}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){e.querySelector(".cards__like-qty").textContent=t.likes.length,l(e)})).catch((function(e){console.log(e)}))},h=function(e,t){return fetch("".concat(_,"/cards/likes/").concat(t),{method:"DELETE",headers:{authorization:y}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){e.querySelector(".cards__like-qty").textContent=t.likes.length,l(e)})).catch((function(e){console.log(e)}))};function S(e){e.classList.add("popup_opened"),document.addEventListener("keydown",g)}function q(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",g)}var g=function(e){if("Escape"===e.key){var t=document.querySelector(".popup_opened");null!==t&&q(t)}},k="";function L(e,t){var r=e.querySelector(H.submitButtonSelector);t?(k=r.textContent,r.textContent="Сохранение..."):setTimeout((function(e){r.textContent=e}),300,k)}var C=function(e,t){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(H.inputErrorClass),r.classList.remove(H.errorClass),r.textContent=""},E=function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?C(e,t):function(e,t,r){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.add(H.inputErrorClass),n.textContent=r,n.classList.add(H.errorClass)}(e,t,t.validationMessage)},b=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(H.inactiveButtonClass)):(t.disabled=!0,t.classList.add(H.inactiveButtonClass))};function j(e){var t=Array.from(e.querySelectorAll(H.inputSelector)),r=e.querySelector(H.submitButtonSelector);t.forEach((function(n){""!==n.value?(E(e,n),b(t,r)):(C(e,n),b(t,r))}))}var x=document.querySelector(".page"),P=document.querySelectorAll(".popup"),A=x.querySelector(".profile__edit"),T=x.querySelector("#edit-profile"),w=T.querySelector('[name="name"]'),z=T.querySelector('[name="spec"]'),U=x.querySelector(".profile__name"),O=x.querySelector(".profile__spec"),B=x.querySelector(".profile__add"),D=T.querySelector(".popup__form"),R=s.querySelector(".popup__form"),N=x.querySelector(".profile__avatar"),F=x.querySelector("#edit-avatar"),I=F.querySelector('[name="link"]'),J=x.querySelector(".profile__pic"),M=F.querySelector(".popup__form");A.addEventListener("click",(function(){w.value=U.textContent,z.value=O.textContent,S(T),j(T)})),B.addEventListener("click",(function(){var e;(e=s).querySelector(".popup__form")&&e.querySelector(".popup__form").reset(),S(s),j(s)})),N.addEventListener("click",(function(){I.value=J.src,S(F),j(F)})),D.addEventListener("submit",(function(e){e.preventDefault(),L(e.target,!0),function(e,t){return fetch("".concat(_,"/users/me"),{method:"PATCH",body:JSON.stringify({name:e,about:t}),headers:{authorization:y,"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(w.value,z.value).then((function(){U.textContent=w.value,O.textContent=z.value,q(T),L(e.target,!1),e.target.reset()}))})),R.addEventListener("submit",(function(e){e.preventDefault();var t=i.value,r=u.value;L(e.target,!0),function(e,t){return fetch("".concat(_,"/cards"),{method:"POST",body:JSON.stringify({name:e,link:t}),headers:{authorization:y,"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))}(t,r).then((function(n){d(t,r,"",f,[],n._id),q(s),L(e.target,!1),e.target.reset()}))})),M.addEventListener("submit",(function(e){e.preventDefault(),L(e.target,!0),function(e){return fetch("".concat(_,"/users/me/avatar"),{method:"PATCH",body:JSON.stringify({avatar:e}),headers:{authorization:y,"Content-Type":"application/json; charset=UTF-8"}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).catch((function(e){console.log(e)}))}(I.value).then((function(){J.src=I.value,J.alt="Аватар",q(F),L(e.target,!1),e.target.reset()}))})),document.querySelectorAll(".popup__close-button").forEach((function(e){var t=e.closest(".popup");e.addEventListener("click",(function(){q(t)}))})),function(e){e.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.value.includes("popup_opened")&&q(e)}))}))}(P),fetch("".concat(_,"/users/me"),{headers:{authorization:y}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){U.textContent=e.name,O.textContent=e.about,J.src=e.avatar,f=e._id})).catch((function(e){U.textContent="Имя пользователя",O.textContent="Профессия",J.src=""})),fetch("".concat(_,"/cards"),{headers:{authorization:y}}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){return e})).then((function(e){e.reverse().forEach((function(e){d(e.name,e.link,e.alt,e.owner._id,e.likes,e._id)}))}));var H={allPopups:".popup",formSelector:".popup__form",formSet:".popup__set",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_inactive",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_active"};!function(e){document.querySelectorAll(e.allPopups).forEach((function(t){var r;r=t,Array.from(r.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(t.querySelectorAll(e.formSet)).forEach((function(t){!function(t){var r=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);r.forEach((function(e){e.addEventListener("input",(function(){E(t,e),b(r,n)}))}))}(t)}))}))}))}(H)})();